<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retro Arcade - 50+ Games</title>
    <link id="favicon" rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üïπÔ∏è</text></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Inter:wght@400;600&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827;
            color: #e5e7eb;
            user-select: none;
            overflow: hidden; /* Prevent body scroll when game is active */
        }

        .font-arcade {
            font-family: 'Press Start 2P', cursive;
        }

        /* Game Canvases */
        canvas {
            border: 2px solid #4b5563;
            background-color: #000;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            max-width: 100%;
        }

        /* Snake Specific */
        #snake-canvas { box-shadow: 0 0 20px rgba(16, 185, 129, 0.2); }
        
        /* Pong Specific */
        #pong-canvas { box-shadow: 0 0 20px rgba(147, 51, 234, 0.2); }

        /* Breakout Specific */
        #breakout-canvas { box-shadow: 0 0 20px rgba(236, 72, 153, 0.2); }

        /* Runner Specific */
        #runner-canvas { box-shadow: 0 0 20px rgba(59, 130, 246, 0.2); }

        /* Tic Tac Toe */
        .ttt-cell {
            transition: all 0.2s;
        }
        .ttt-cell:hover:not(:disabled) {
            background-color: #374151;
        }

        /* Memory Card */
        .memory-card { perspective: 1000px; }
        .memory-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .memory-card.flipped .memory-card-inner { transform: rotateY(180deg); }
        .memory-card-front, .memory-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0.5rem;
        }
        .memory-card-front { background-color: #1f2937; border: 2px solid #4b5563; }
        .memory-card-back { background-color: #3b82f6; transform: rotateY(180deg); border: 2px solid #60a5fa; font-size: 2rem; }

        /* Whack-a-Mole */
        .mole-hole { overflow: hidden; position: relative; }
        .mole { transition: top 0.2s; }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1f2937; }
        ::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #6b7280; }
        
        /* Iframe Container */
        #io-game-frame {
            background: #000;
        }

        /* Teacher Mode Styling */
        #teacher-mode-overlay {
            font-family: "Times New Roman", Times, serif;
            background: white;
            color: black;
            padding: 40px;
            line-height: 1.6;
            z-index: 9999;
        }
    </style>
</head>
<body class="h-screen flex flex-col">

    <!-- Header -->
    <header class="p-4 md:p-6 text-center border-b border-gray-800 bg-gray-900 shadow-lg z-10 flex-shrink-0 relative">
        <h1 class="font-arcade text-xl md:text-3xl text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600 animate-pulse">
            RETRO ARCADE
        </h1>
        <!-- Teacher Mode Button -->
        <button onclick="toggleTeacherMode()" class="absolute top-4 right-4 text-xs bg-gray-700 hover:bg-gray-600 text-gray-400 px-2 py-1 rounded border border-gray-600" title="Shortcut: Press '='">
            üéì Teacher Mode
        </button>
    </header>

    <!-- Navigation Tabs -->
    <div id="nav-tabs" class="flex justify-center bg-gray-900 border-b border-gray-800 flex-shrink-0">
        <div class="flex space-x-2 p-2 overflow-x-auto">
            <button onclick="switchTab('classics')" id="tab-classics" class="px-4 py-2 rounded-lg bg-purple-600 text-white font-bold text-sm whitespace-nowrap transition">üïπÔ∏è Classics</button>
            <button onclick="switchTab('io')" id="tab-io" class="px-4 py-2 rounded-lg hover:bg-gray-800 text-gray-400 font-bold text-sm whitespace-nowrap transition">üåê IO Arena</button>
            <button onclick="switchTab('vault')" id="tab-vault" class="px-4 py-2 rounded-lg hover:bg-gray-800 text-gray-400 font-bold text-sm whitespace-nowrap transition">üîì The Vault</button>
        </div>
    </div>

    <!-- Main Content Area -->
    <main class="flex-grow flex flex-col items-center p-4 overflow-y-auto w-full relative">
        
        <!-- CLASSICS SECTION -->
        <div id="section-classics" class="w-full max-w-6xl">
            <h2 class="text-xl font-bold text-white mb-4 border-l-4 border-purple-500 pl-3">Playable Now</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                
                <!-- Snake Card -->
                <div onclick="loadGame('snake')" class="bg-gray-800 p-6 rounded-xl border border-gray-700 hover:border-green-500 hover:shadow-[0_0_20px_rgba(16,185,129,0.3)] transition cursor-pointer group flex flex-col items-center gap-4">
                    <div class="text-5xl group-hover:scale-110 transition duration-300">üêç</div>
                    <div class="text-center">
                        <h2 class="text-xl font-bold text-white">Neon Snake</h2>
                        <p class="text-gray-400 text-sm">Classic snake game</p>
                    </div>
                </div>

                <!-- Pong Card -->
                <div onclick="loadGame('pong')" class="bg-gray-800 p-6 rounded-xl border border-gray-700 hover:border-purple-500 hover:shadow-[0_0_20px_rgba(147,51,234,0.3)] transition cursor-pointer group flex flex-col items-center gap-4">
                    <div class="text-5xl group-hover:scale-110 transition duration-300">üèì</div>
                    <div class="text-center">
                        <h2 class="text-xl font-bold text-white">Retro Pong</h2>
                        <p class="text-gray-400 text-sm">Beat the AI paddle</p>
                    </div>
                </div>

                <!-- Breakout Card -->
                <div onclick="loadGame('breakout')" class="bg-gray-800 p-6 rounded-xl border border-gray-700 hover:border-pink-500 hover:shadow-[0_0_20px_rgba(236,72,153,0.3)] transition cursor-pointer group flex flex-col items-center gap-4">
                    <div class="text-5xl group-hover:scale-110 transition duration-300">üß±</div>
                    <div class="text-center">
                        <h2 class="text-xl font-bold text-white">Breakout</h2>
                        <p class="text-gray-400 text-sm">Smash all the bricks</p>
                    </div>
                </div>

                <!-- Tic Tac Toe Card -->
                <div onclick="loadGame('tictactoe')" class="bg-gray-800 p-6 rounded-xl border border-gray-700 hover:border-blue-500 hover:shadow-[0_0_20px_rgba(59,130,246,0.3)] transition cursor-pointer group flex flex-col items-center gap-4">
                    <div class="text-5xl group-hover:scale-110 transition duration-300">‚ùå‚≠ï</div>
                    <div class="text-center">
                        <h2 class="text-xl font-bold text-white">Tic Tac Toe</h2>
                        <p class="text-gray-400 text-sm">3x3 Strategy</p>
                    </div>
                </div>

                <!-- Memory Match Card -->
                <div onclick="loadGame('memory')" class="bg-gray-800 p-6 rounded-xl border border-gray-700 hover:border-yellow-500 hover:shadow-[0_0_20px_rgba(234,179,8,0.3)] transition cursor-pointer group flex flex-col items-center gap-4">
                    <div class="text-5xl group-hover:scale-110 transition duration-300">üÉè</div>
                    <div class="text-center">
                        <h2 class="text-xl font-bold text-white">Memory Match</h2>
                        <p class="text-gray-400 text-sm">Test your focus</p>
                    </div>
                </div>

                 <!-- Whack a Mole Card -->
                 <div onclick="loadGame('whack')" class="bg-gray-800 p-6 rounded-xl border border-gray-700 hover:border-red-500 hover:shadow-[0_0_20px_rgba(239,68,68,0.3)] transition cursor-pointer group flex flex-col items-center gap-4">
                    <div class="text-5xl group-hover:scale-110 transition duration-300">üî®</div>
                    <div class="text-center">
                        <h2 class="text-xl font-bold text-white">Whack-a-Mole</h2>
                        <p class="text-gray-400 text-sm">Fast reaction test</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- IO ARENA SECTION (STEALTH MIRRORS) -->
        <div id="section-io" class="w-full max-w-6xl hidden">
            <h2 class="text-xl font-bold text-white mb-4 border-l-4 border-blue-500 pl-3">IO Arena (Stealth Mirrors)</h2>
            <div class="bg-blue-900/30 border border-blue-800 p-3 mb-6 rounded-lg text-sm text-blue-200 flex flex-col md:flex-row justify-between items-center gap-3">
                <span>‚ö° Using K12-specific mirrors & About:Blank Cloaking.</span>
                <button onclick="cloakGame('https://bloxdk12.com')" class="bg-blue-600 hover:bg-blue-500 text-white px-3 py-1 rounded text-xs font-bold transition flex items-center gap-2">
                    üé≠ Open Bloxd in Secret Tab
                </button>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                
                <!-- BLOXD.IO UNBLOCKED (PRIMARY) -->
                <div onclick="embedGame('https://bloxdk12.com', 'Bloxd.io Unblocked')" class="cursor-pointer bg-gray-900 p-4 rounded-xl border-2 border-yellow-500 hover:border-yellow-400 hover:bg-gray-800 transition flex flex-col items-center text-center gap-2 shadow-[0_0_15px_rgba(234,179,8,0.4)]">
                    <span class="text-4xl">‚öíÔ∏è</span> 
                    <span class="font-bold text-white">BLOXD.IO</span> 
                    <span class="text-xs text-yellow-400 font-bold">K12 MIRROR ‚ñ∂</span>
                </div>

                <!-- DOODLECUBE (BACKUP MIRROR) -->
                <div onclick="embedGame('https://doodlecube.io', 'DoodleCube')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">üé®</span> 
                    <span class="font-bold text-white">DoodleCube</span> 
                    <span class="text-xs text-green-400">Alt Bloxd Link ‚ñ∂</span>
                </div>

                <!-- FreezeNova / General Unblocked -->
                 <div onclick="embedGame('https://unblocked-games.s3.amazonaws.com/bloxd.html', 'FreezeNova Proxy')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">‚ùÑÔ∏è</span> 
                    <span class="font-bold text-white">FreezeNova</span> 
                    <span class="text-xs text-green-400">AWS Proxy ‚ñ∂</span>
                </div>
                
                <!-- Neon 3D (Github Mirror) -->
                <div onclick="embedGame('https://j-speed13.github.io/neon3d.github.io/', 'Neon 3D')" class="cursor-pointer bg-gray-900 p-4 rounded-xl border-2 border-purple-500 hover:border-pink-500 hover:bg-gray-800 transition flex flex-col items-center text-center gap-2 shadow-[0_0_15px_rgba(168,85,247,0.4)]">
                    <span class="text-4xl">üöÄ</span> 
                    <span class="font-bold text-white italic text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-500">NEON 3D</span> 
                    <span class="text-xs text-green-400 font-bold">UNBLOCKED ‚ñ∂</span>
                </div>

                <!-- Poxel -->
                <div onclick="embedGame('https://poxel.io', 'Poxel.io')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">üì¶</span> 
                    <span class="font-bold text-white">Poxel.io</span> 
                    <span class="text-xs text-blue-400">Play Now ‚ñ∂</span>
                </div>

                <!-- 1v1.LOL (Github Mirror) -->
                <div onclick="embedGame('https://1v1-lol.github.io/', '1v1.LOL')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">‚öîÔ∏è</span> 
                    <span class="font-bold text-white">1v1.LOL</span> 
                    <span class="text-xs text-green-400">GH Mirror ‚ñ∂</span>
                </div>

                <!-- Krunker (BrowserFPS Mirror) -->
                <div onclick="embedGame('https://browserfps.com/', 'Krunker.io')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">üéØ</span> 
                    <span class="font-bold text-white">Krunker.io</span> 
                    <span class="text-xs text-green-400">Proxy Site ‚ñ∂</span>
                </div>

                <!-- Hole.io (.com Mirror) -->
                <div onclick="embedGame('https://hole-io.com', 'Hole.io')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">üï≥Ô∏è</span> <span class="font-bold text-white">Hole.io</span> <span class="text-xs text-green-400">Unblocked ‚ñ∂</span>
                </div>

                <!-- Paper.io 2 (.com Mirror) -->
                <div onclick="embedGame('https://paperio2.com', 'Paper.io 2')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">üìÉ</span> <span class="font-bold text-white">Paper.io 2</span> <span class="text-xs text-green-400">Unblocked ‚ñ∂</span>
                </div>
                
                <!-- Slither (.com Mirror) -->
                <div onclick="embedGame('http://slither.com', 'Slither.io')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">üêõ</span> <span class="font-bold text-white">Slither.io</span> <span class="text-xs text-green-400">HTTP Mirror ‚ñ∂</span>
                </div>

                <!-- Voxiom -->
                <div onclick="embedGame('https://voxiom.io', 'Voxiom.io')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">üî´</span> <span class="font-bold text-white">Voxiom</span> <span class="text-xs text-blue-400">Play Now ‚ñ∂</span>
                </div>

                <!-- Agar.io -->
                <div onclick="embedGame('https://agar.io', 'Agar.io')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">ü¶†</span> <span class="font-bold text-white">Agar.io</span> <span class="text-xs text-blue-400">Play Now ‚ñ∂</span>
                </div>
 
                <!-- Diep.io -->
                 <div onclick="embedGame('https://diep.io', 'Diep.io')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">üîµ</span> <span class="font-bold text-white">Diep.io</span> <span class="text-xs text-blue-400">Play Now ‚ñ∂</span>
                </div>
                
                <!-- Snake.io -->
                <div onclick="embedGame('https://snake.io', 'Snake.io')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">üêç</span> <span class="font-bold text-white">Snake.io</span> <span class="text-xs text-blue-400">Play Now ‚ñ∂</span>
                </div>
                
                 <div onclick="embedGame('https://skribbl.io', 'Skribbl.io')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">‚úèÔ∏è</span> <span class="font-bold text-white">Skribbl.io</span> <span class="text-xs text-blue-400">Play Now ‚ñ∂</span>
                </div>
                <div onclick="embedGame('https://wings.io', 'Wings.io')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">‚úàÔ∏è</span> <span class="font-bold text-white">Wings.io</span> <span class="text-xs text-blue-400">Play Now ‚ñ∂</span>
                </div>
                 <div onclick="embedGame('https://gartic.io', 'Gartic.io')" class="cursor-pointer bg-gray-800 p-4 rounded-xl border border-gray-700 hover:border-blue-400 hover:bg-gray-700 transition flex flex-col items-center text-center gap-2">
                    <span class="text-4xl">üé®</span> <span class="font-bold text-white">Gartic.io</span> <span class="text-xs text-blue-400">Play Now ‚ñ∂</span>
                </div>
            </div>
        </div>

        <!-- THE VAULT (UNLOCKED) -->
        <div id="section-vault" class="w-full max-w-6xl hidden">
            <h2 class="text-xl font-bold text-white mb-4 border-l-4 border-green-500 pl-3">The Vault (UNLOCKED)</h2>
            <p class="text-gray-400 mb-6 text-sm">Select a cartridge to load the Universal Game Engine.</p>
            <div id="vault-grid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3">
                <!-- Populated by JS -->
            </div>
        </div>

        <!-- ACTIVE GAME CONTAINER -->
        <div id="game-container" class="hidden w-full max-w-4xl flex-col items-center mt-4">
            <!-- Navigation -->
            <div class="w-full flex justify-between items-center mb-6 bg-gray-800 p-4 rounded-lg">
                <button onclick="exitGame()" class="flex items-center gap-2 text-gray-400 hover:text-white transition">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                    <span>Back</span>
                </button>
                <h2 id="active-game-title" class="text-lg font-bold text-white">Game Title</h2>
                <div class="w-16"></div>
            </div>

            <!-- Snake View -->
            <div id="snake-game" class="hidden flex flex-col items-center w-full game-view">
                <div class="flex gap-4 mb-2">
                    <span class="text-gray-400">Score:</span>
                    <span id="snake-score" class="font-bold text-green-400">0</span>
                </div>
                <canvas id="snake-canvas" width="400" height="400" class="rounded-lg mb-6"></canvas>
                 <div class="grid grid-cols-3 gap-2 md:hidden">
                    <div></div><button onclick="snakeInput('Up')" class="w-14 h-14 bg-gray-700 rounded-full flex items-center justify-center text-xl">‚¨ÜÔ∏è</button><div></div>
                    <button onclick="snakeInput('Left')" class="w-14 h-14 bg-gray-700 rounded-full flex items-center justify-center text-xl">‚¨ÖÔ∏è</button>
                    <button onclick="snakeInput('Down')" class="w-14 h-14 bg-gray-700 rounded-full flex items-center justify-center text-xl">‚¨áÔ∏è</button>
                    <button onclick="snakeInput('Right')" class="w-14 h-14 bg-gray-700 rounded-full flex items-center justify-center text-xl">‚û°Ô∏è</button>
                </div>
                <p class="hidden md:block text-gray-500 text-xs mt-2">Arrow Keys to move</p>
            </div>

            <!-- Pong View -->
            <div id="pong-game" class="hidden flex flex-col items-center w-full game-view">
                <div class="flex gap-8 mb-2">
                     <div class="text-center"><span class="text-gray-400 text-xs">YOU</span><div id="pong-score-p" class="font-bold text-purple-400 text-xl">0</div></div>
                     <div class="text-center"><span class="text-gray-400 text-xs">AI</span><div id="pong-score-ai" class="font-bold text-red-400 text-xl">0</div></div>
                </div>
                <canvas id="pong-canvas" width="400" height="300" class="rounded-lg mb-4"></canvas>
                <div class="flex gap-4 md:hidden w-full justify-center">
                    <button ontouchstart="movePongPaddle(-1)" ontouchend="stopPongPaddle()" class="w-20 h-16 bg-gray-700 rounded-lg flex items-center justify-center text-xl">‚¨ÜÔ∏è</button>
                    <button ontouchstart="movePongPaddle(1)" ontouchend="stopPongPaddle()" class="w-20 h-16 bg-gray-700 rounded-lg flex items-center justify-center text-xl">‚¨áÔ∏è</button>
                </div>
                <p class="hidden md:block text-gray-500 text-xs mt-2">Use Up/Down Arrows</p>
            </div>

            <!-- Breakout View -->
            <div id="breakout-game" class="hidden flex flex-col items-center w-full game-view">
                <div class="flex gap-4 mb-2">
                    <span class="text-gray-400">Score:</span>
                    <span id="breakout-score" class="font-bold text-pink-400">0</span>
                </div>
                <canvas id="breakout-canvas" width="400" height="400" class="rounded-lg mb-4"></canvas>
                 <div class="flex gap-4 md:hidden w-full justify-center">
                    <button ontouchstart="moveBreakoutPaddle(-1)" ontouchend="stopBreakoutPaddle()" class="w-20 h-16 bg-gray-700 rounded-lg flex items-center justify-center text-xl">‚¨ÖÔ∏è</button>
                    <button ontouchstart="moveBreakoutPaddle(1)" ontouchend="stopBreakoutPaddle()" class="w-20 h-16 bg-gray-700 rounded-lg flex items-center justify-center text-xl">‚û°Ô∏è</button>
                </div>
                <p class="hidden md:block text-gray-500 text-xs mt-2">Left/Right Arrows to move</p>
            </div>

            <!-- Runner View (Vault Engine) -->
            <div id="runner-game" class="hidden flex flex-col items-center w-full game-view">
                <div class="flex gap-4 mb-2">
                    <span class="text-gray-400">Score:</span>
                    <span id="runner-score" class="font-bold text-blue-400">0</span>
                </div>
                <canvas id="runner-canvas" width="600" height="300" class="rounded-lg mb-4 bg-gray-900"></canvas>
                 <div class="flex gap-4 md:hidden w-full justify-center">
                    <button ontouchstart="runnerJump()" class="w-full h-16 bg-blue-600 rounded-lg flex items-center justify-center text-xl font-bold">JUMP</button>
                </div>
                <p class="hidden md:block text-gray-500 text-xs mt-2">Press SPACE or UP to Jump</p>
            </div>

            <!-- Tic Tac Toe View -->
            <div id="tictactoe-game" class="hidden flex flex-col items-center game-view">
                <div id="ttt-status" class="mb-6 text-xl font-bold text-blue-400">Player X's Turn</div>
                <div class="grid grid-cols-3 gap-2 bg-gray-700 p-2 rounded-xl"></div>
                <button onclick="resetTTT()" class="mt-8 px-6 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white transition">Reset Board</button>
            </div>

            <!-- Memory Game View -->
            <div id="memory-game" class="hidden flex flex-col items-center w-full game-view">
                 <div class="flex gap-4 mb-2">
                    <span class="text-gray-400">Moves:</span>
                    <span id="memory-moves" class="font-bold text-yellow-400">0</span>
                </div>
                <div id="memory-grid" class="grid grid-cols-4 gap-3 md:gap-4"></div>
                <button onclick="initMemory()" class="mt-8 px-6 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-white transition">Restart</button>
            </div>

            <!-- Whack a Mole View -->
            <div id="whack-game" class="hidden flex flex-col items-center w-full game-view">
                <div class="flex gap-8 mb-6">
                    <div><span class="text-gray-400 text-xs">Score</span><div id="whack-score" class="text-2xl font-mono font-bold text-red-400">0</div></div>
                     <div><span class="text-gray-400 text-xs">Time</span><div id="whack-time" class="text-2xl font-mono font-bold text-white">30</div></div>
                </div>
                <div class="grid grid-cols-3 gap-4 bg-gray-800 p-6 rounded-2xl border border-gray-700">
                     <script>
                        for(let i=0; i<9; i++) {
                            document.write(`<div class="w-16 h-16 md:w-20 md:h-20 bg-gray-900 rounded-full relative overflow-hidden cursor-pointer mole-hole" onclick="bonk(this)"><div class="mole absolute w-full h-full bg-red-500 rounded-full top-24 flex items-center justify-center text-3xl transition-all duration-100">üêπ</div></div>`);
                        }
                     </script>
                </div>
                <button id="whack-start-btn" onclick="startWhackGame()" class="mt-8 px-6 py-2 bg-red-600 hover:bg-red-500 rounded-lg text-white transition font-bold">Start Game</button>
            </div>
        </div>

        <!-- EMBEDDED IO GAME CONTAINER -->
        <div id="io-embed-container" class="hidden absolute top-0 left-0 w-full h-full bg-gray-900 flex-col z-50">
            <div class="flex items-center justify-between p-3 bg-gray-800 border-b border-gray-700">
                <div class="flex gap-2">
                    <button onclick="closeEmbed()" class="flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-500 text-white rounded-lg font-bold transition text-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                        Close
                    </button>
                    <button onclick="toggleFullScreen()" class="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg font-bold transition text-sm">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/></svg>
                        Full Screen
                    </button>
                </div>
                <span id="io-game-title" class="font-bold text-white hidden md:block">IO Game</span>
                <a id="io-fallback-link" href="#" target="_blank" class="text-blue-400 text-xs hover:text-white flex items-center gap-1">
                    Is the screen white? Try Google Translate Proxy ‚Üó
                </a>
            </div>
            <iframe id="io-game-frame" src="" class="flex-grow w-full border-0 bg-black" allow="fullscreen"></iframe>
        </div>

        <!-- TEACHER MODE OVERLAY -->
        <div id="teacher-mode-overlay" class="hidden fixed inset-0 w-full h-full bg-white z-[100]">
            <h1 style="font-size: 24px; color: black; border-bottom: 1px solid #ccc; padding-bottom: 10px;">History of the Calculator</h1>
            <p style="margin-top: 20px;">The first mechanical calculator, the Pascaline, was invented by Blaise Pascal in 1642. It could only perform addition and subtraction. Later, Gottfried Wilhelm Leibniz invented the Stepped Reckoner in 1672, which could also perform multiplication and division.</p>
            <p>In the 19th century, Charles Babbage designed the Difference Engine and the Analytical Engine, which are considered the precursors to modern computers. However, these machines were never fully completed during his lifetime.</p>
            <p>The electronic calculator was developed in the 1960s, and by the 1970s, pocket-sized calculators became widely available. Today, calculators are integrated into computers and smartphones.</p>
            <div style="margin-top: 40px; font-style: italic; color: #666;">Source: Educational Historical Archives, Vol 4.</div>
        </div>

    </main>

    <footer class="p-4 text-center text-gray-600 text-xs border-t border-gray-800 flex-shrink-0">
        &copy; 2024 Retro Arcade Inc.
    </footer>

    <!-- LOGIC -->
    <script>
        // --- GLOBAL STATE & TAB LOGIC ---
        let currentGame = null;

        // Teacher Mode Logic
        function toggleTeacherMode() {
            const overlay = document.getElementById('teacher-mode-overlay');
            const favicon = document.getElementById('favicon');
            
            if (overlay.classList.contains('hidden')) {
                overlay.classList.remove('hidden');
                document.title = "History of Calculators - Wikipedia";
                favicon.href = "https://en.wikipedia.org/static/favicon/wikipedia.ico"; // Fake Wiki Icon
            } else {
                overlay.classList.add('hidden');
                document.title = "Retro Arcade - 50+ Games";
                favicon.href = "data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üïπÔ∏è</text></svg>";
            }
        }

        // Keyboard Shortcut for Teacher Mode
        document.addEventListener('keydown', (e) => {
            if (e.key === '=') {
                toggleTeacherMode();
            }
        });

        // --- CLOAKING LOGIC ---
        function cloakGame(url) {
            const win = window.open();
            if (!win) {
                alert("Pop-up blocked! Allow pop-ups to use Secret Mode.");
                return;
            }
            const urlToLoad = url;
            const iframe = win.document.createElement('iframe');
            
            // Set styles to fill the blank page
            win.document.body.style.margin = '0';
            win.document.body.style.height = '100vh';
            win.document.body.style.backgroundColor = 'black';
            iframe.style.border = 'none';
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            iframe.src = urlToLoad;
            
            win.document.body.appendChild(iframe);
            
            // Set the blank page title to something boring
            win.document.title = "Google Docs";
            
            // Add a favicon to look like Google Docs
            const link = win.document.createElement('link');
            link.rel = 'icon';
            link.href = 'https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico';
            win.document.head.appendChild(link);
        }

        function switchTab(tabId) {
            // Update Tab UI
            ['classics', 'io', 'vault'].forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                const sec = document.getElementById(`section-${t}`);
                if (t === tabId) {
                    btn.classList.add('bg-purple-600', 'text-white');
                    btn.classList.remove('text-gray-400', 'hover:bg-gray-800');
                    sec.classList.remove('hidden');
                } else {
                    btn.classList.remove('bg-purple-600', 'text-white');
                    btn.classList.add('text-gray-400', 'hover:bg-gray-800');
                    sec.classList.add('hidden');
                }
            });
            
            // Generate vault if empty
            if (tabId === 'vault' && document.getElementById('vault-grid').children.length === 0) {
                populateVault();
            }
        }

        function populateVault() {
            const grid = document.getElementById('vault-grid');
            const titles = [
                "Cyber Run", "Pixel Jump", "Void Walker", "Star Dash", "Neon Rider", "Grid Lock",
                "Alpha Wave", "Beta Block", "Gamma Ray", "Delta Force", "Omega Zen", "Zeta Prime",
                "Astro Hopper", "Moon Patrol", "Mars Rover", "Sun Chaser", "Comet Surfer", "Black Hole",
                "Retro Racer", "8-Bit Hero", "Glitch City", "Data Stream", "Bit Crusher", "System Shock"
            ];
            
            titles.forEach((title, i) => {
                const div = document.createElement('div');
                // Randomize icon slightly
                const icons = ['üíæ', 'üíø', 'üïπÔ∏è', 'üì∫', 'üöÄ', 'üëæ'];
                const icon = icons[i % icons.length];
                
                div.className = "bg-gray-800 p-3 rounded-lg flex flex-col items-center justify-center text-center cursor-pointer hover:bg-gray-700 hover:border-green-500 border border-gray-700 transition group h-24";
                div.onclick = () => loadGame('runner', title);
                div.innerHTML = `
                    <span class="text-2xl mb-1 group-hover:scale-110 transition">${icon}</span>
                    <span class="text-xs font-bold text-gray-300 group-hover:text-white leading-tight">${title}</span>
                `;
                grid.appendChild(div);
            });
        }

        function loadGame(gameId, variantTitle = null) {
            ['section-classics', 'section-io', 'section-vault'].forEach(id => document.getElementById(id).classList.add('hidden'));
            document.getElementById('nav-tabs').classList.add('hidden'); // Hide tabs to give more space
            
            document.getElementById('game-container').classList.remove('hidden');
            document.getElementById('game-container').classList.add('flex');
            document.querySelectorAll('.game-view').forEach(el => el.classList.add('hidden'));

            currentGame = gameId;

            let displayTitle = '';
            if (gameId === 'runner') {
                displayTitle = variantTitle || "Galaxy Runner";
                document.getElementById('runner-game').classList.remove('hidden');
                initRunner(variantTitle); // Pass title for seeding colors
            } else {
                 const titles = {
                    'snake': 'Neon Snake', 'pong': 'Retro Pong', 'breakout': 'Breakout',
                    'tictactoe': 'Tic Tac Toe', 'memory': 'Memory Match', 'whack': 'Whack-a-Mole'
                };
                displayTitle = titles[gameId];
                document.getElementById(`${gameId}-game`).classList.remove('hidden');
            }

            document.getElementById('active-game-title').innerText = displayTitle;

            if (gameId === 'snake') initSnake();
            if (gameId === 'pong') initPong();
            if (gameId === 'breakout') initBreakout();
            if (gameId === 'tictactoe') initTTT();
            if (gameId === 'memory') initMemory();
            if (gameId === 'whack') resetWhackUI();
        }

        function exitGame() {
            stopSnake();
            stopPong();
            stopBreakout();
            stopWhack();
            stopRunner();

            document.getElementById('game-container').classList.add('hidden');
            document.getElementById('game-container').classList.remove('flex');
            document.getElementById('nav-tabs').classList.remove('hidden'); // Show tabs again
            
            // Return to current tab context, but default to classics if confusing
            if(currentGame === 'runner') switchTab('vault');
            else switchTab('classics');
        }

        // --- IO EMBED LOGIC ---
        function embedGame(url, title) {
             const container = document.getElementById('io-embed-container');
             const frame = document.getElementById('io-game-frame');
             const fallback = document.getElementById('io-fallback-link');
             const titleEl = document.getElementById('io-game-title');

             // Set Props
             frame.src = url;
             
             // Setup Google Translate Proxy Link
             const proxyUrl = `https://translate.google.com/translate?sl=auto&tl=en&u=${encodeURIComponent(url)}`;
             fallback.href = proxyUrl;
             
             titleEl.innerText = title;

             // Show Container
             container.classList.remove('hidden');
             container.classList.add('flex');
        }

        function closeEmbed() {
             const container = document.getElementById('io-embed-container');
             const frame = document.getElementById('io-game-frame');
             
             // Reset
             frame.src = ''; // Stops audio/game
             container.classList.add('hidden');
             container.classList.remove('flex');
             
             // Ensure we are back on IO tab
             switchTab('io');
        }

        function toggleFullScreen() {
            const frame = document.getElementById('io-game-frame');
            if (frame.requestFullscreen) {
                frame.requestFullscreen();
            } else if (frame.webkitRequestFullscreen) { /* Safari */
                frame.webkitRequestFullscreen();
            } else if (frame.msRequestFullscreen) { /* IE11 */
                frame.msRequestFullscreen();
            }
        }


        // --- GAME 1: SNAKE ---
        let snakeCanvas = document.getElementById('snake-canvas');
        let snakeCtx = snakeCanvas.getContext('2d');
        let snakeInterval;
        let snake = [];
        let food = {};
        let direction = 'right';
        let nextDirection = 'right';
        let snakeScore = 0;
        const gridSize = 20;
        const tileCount = 20;

        function initSnake() {
            snake = [{x: 10, y: 10}];
            food = spawnFood();
            direction = 'right';
            nextDirection = 'right';
            snakeScore = 0;
            document.getElementById('snake-score').innerText = snakeScore;
            if (snakeInterval) clearInterval(snakeInterval);
            snakeInterval = setInterval(gameLoopSnake, 100);
            document.addEventListener('keydown', handleSnakeKey);
        }
        function stopSnake() { clearInterval(snakeInterval); document.removeEventListener('keydown', handleSnakeKey); }
        function spawnFood() { return { x: Math.floor(Math.random() * tileCount), y: Math.floor(Math.random() * tileCount) }; }
        function handleSnakeKey(e) {
            switch(e.key) {
                case 'ArrowUp': if(direction !== 'down') nextDirection = 'up'; break;
                case 'ArrowDown': if(direction !== 'up') nextDirection = 'down'; break;
                case 'ArrowLeft': if(direction !== 'right') nextDirection = 'left'; break;
                case 'ArrowRight': if(direction !== 'left') nextDirection = 'right'; break;
            }
        }
        function snakeInput(dir) { const k = {'Up':'ArrowUp','Down':'ArrowDown','Left':'ArrowLeft','Right':'ArrowRight'}; handleSnakeKey({key: k[dir]}); }
        function gameLoopSnake() {
            direction = nextDirection;
            let head = {x: snake[0].x, y: snake[0].y};
            if (direction === 'right') head.x++; else if (direction === 'left') head.x--; else if (direction === 'up') head.y--; else if (direction === 'down') head.y++;
            if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) { gameOverSnake(); return; }
            for (let i = 0; i < snake.length; i++) { if (head.x === snake[i].x && head.y === snake[i].y) { gameOverSnake(); return; } }
            snake.unshift(head);
            if (head.x === food.x && head.y === food.y) { snakeScore += 10; document.getElementById('snake-score').innerText = snakeScore; food = spawnFood(); } else { snake.pop(); }
            // Draw
            snakeCtx.fillStyle = '#000'; snakeCtx.fillRect(0, 0, 400, 400);
            snakeCtx.fillStyle = '#ef4444'; snakeCtx.fillRect(food.x * 20, food.y * 20, 18, 18);
            snakeCtx.fillStyle = '#10b981'; snake.forEach(p => snakeCtx.fillRect(p.x * 20, p.y * 20, 18, 18));
        }
        function gameOverSnake() { clearInterval(snakeInterval); alert(`Game Over! Score: ${snakeScore}`); initSnake(); }


        // --- GAME 2: PONG ---
        let pongCanvas = document.getElementById('pong-canvas');
        let pongCtx = pongCanvas.getContext('2d');
        let pongInterval;
        let playerY = 110, aiY = 110;
        let ballX = 200, ballY = 150;
        let ballDX = 4, ballDY = 4;
        let playerScore = 0, aiScore = 0;
        const PADDLE_H = 80, PADDLE_W = 10;
        let pongMoveDir = 0; // -1 up, 1 down, 0 stop

        function initPong() {
            playerY = 110; aiY = 110; ballX = 200; ballY = 150;
            playerScore = 0; aiScore = 0;
            updatePongScore();
            if (pongInterval) clearInterval(pongInterval);
            pongInterval = setInterval(loopPong, 1000/60);
            document.addEventListener('keydown', handlePongKey);
            document.addEventListener('keyup', () => pongMoveDir = 0);
        }
        function stopPong() { clearInterval(pongInterval); document.removeEventListener('keydown', handlePongKey); }
        function handlePongKey(e) { if(e.key === 'ArrowUp') pongMoveDir = -1; if(e.key === 'ArrowDown') pongMoveDir = 1; }
        function movePongPaddle(dir) { pongMoveDir = dir; }
        function stopPongPaddle() { pongMoveDir = 0; }
        function updatePongScore() { document.getElementById('pong-score-p').innerText = playerScore; document.getElementById('pong-score-ai').innerText = aiScore; }
        
        function loopPong() {
            // Move Player
            playerY += pongMoveDir * 6;
            if(playerY < 0) playerY = 0; if(playerY > 300 - PADDLE_H) playerY = 300 - PADDLE_H;

            // Move AI
            let aiCenter = aiY + PADDLE_H/2;
            if(aiCenter < ballY - 35) aiY += 4;
            else if(aiCenter > ballY + 35) aiY -= 4;
            if(aiY < 0) aiY = 0; if(aiY > 300 - PADDLE_H) aiY = 300 - PADDLE_H;

            // Move Ball
            ballX += ballDX; ballY += ballDY;

            // Ball Collisions Wall
            if(ballY < 0 || ballY > 300) ballDY = -ballDY;

            // Paddle Collisions
            // Player
            if(ballX < 20 && ballY > playerY && ballY < playerY + PADDLE_H) {
                ballDX = -ballDX;
                ballDX *= 1.05; // speed up
            }
            // AI
            if(ballX > 380 && ballY > aiY && ballY < aiY + PADDLE_H) {
                ballDX = -ballDX;
            }

            // Score
            if(ballX < 0) { aiScore++; resetBall(); }
            if(ballX > 400) { playerScore++; resetBall(); }

            // Draw
            pongCtx.fillStyle = '#000'; pongCtx.fillRect(0,0,400,300);
            pongCtx.fillStyle = '#a855f7'; pongCtx.fillRect(10, playerY, PADDLE_W, PADDLE_H);
            pongCtx.fillStyle = '#ef4444'; pongCtx.fillRect(380, aiY, PADDLE_W, PADDLE_H);
            pongCtx.beginPath(); pongCtx.arc(ballX, ballY, 6, 0, Math.PI*2); pongCtx.fillStyle='#fff'; pongCtx.fill();
            // Net
            pongCtx.strokeStyle = '#333'; pongCtx.beginPath(); pongCtx.setLineDash([5, 15]); pongCtx.moveTo(200,0); pongCtx.lineTo(200,300); pongCtx.stroke();
        }
        function resetBall() { ballX = 200; ballY = 150; ballDX = -ballDX; ballDX = (Math.abs(ballDX) > 8) ? (ballDX > 0 ? 4 : -4) : ballDX; updatePongScore(); }


        // --- GAME 3: BREAKOUT ---
        let breakCanvas = document.getElementById('breakout-canvas');
        let breakCtx = breakCanvas.getContext('2d');
        let breakInterval;
        let paddleX = 160;
        let bBallX = 200, bBallY = 300;
        let bBallDX = 3, bBallDY = -3;
        let bricks = [];
        let breakScore = 0;
        let breakMoveDir = 0;

        function initBreakout() {
            paddleX = 160; bBallX = 200; bBallY = 300; bBallDX = 3; bBallDY = -3; breakScore = 0;
            document.getElementById('breakout-score').innerText = 0;
            // Create Bricks
            bricks = [];
            for(let c=0; c<5; c++) {
                bricks[c] = [];
                for(let r=0; r<4; r++) {
                    bricks[c][r] = { x: 0, y: 0, status: 1 };
                }
            }
            if(breakInterval) clearInterval(breakInterval);
            breakInterval = setInterval(loopBreakout, 10);
            document.addEventListener('keydown', handleBreakKey);
            document.addEventListener('keyup', () => breakMoveDir = 0);
        }
        function stopBreakout() { clearInterval(breakInterval); document.removeEventListener('keydown', handleBreakKey); }
        function handleBreakKey(e) { if(e.key === 'ArrowLeft') breakMoveDir = -1; if(e.key === 'ArrowRight') breakMoveDir = 1; }
        function moveBreakoutPaddle(dir) { breakMoveDir = dir; }
        function stopBreakoutPaddle() { breakMoveDir = 0; }

        function loopBreakout() {
            // Move Paddle
            paddleX += breakMoveDir * 5;
            if(paddleX < 0) paddleX = 0; if(paddleX > 400 - 80) paddleX = 400 - 80;

            // Move Ball
            bBallX += bBallDX; bBallY += bBallDY;
            if(bBallX > 400-5 || bBallX < 5) bBallDX = -bBallDX;
            if(bBallY < 5) bBallDY = -bBallDY;
            else if(bBallY > 400-5) {
                if(bBallX > paddleX && bBallX < paddleX + 80) {
                     bBallDY = -bBallDY;
                } else {
                    // Loss
                    clearInterval(breakInterval);
                    alert("Game Over");
                    initBreakout();
                    return;
                }
            }

            // Brick Collision
            let bricksLeft = 0;
            for(let c=0; c<5; c++) {
                for(let r=0; r<4; r++) {
                    let b = bricks[c][r];
                    if(b.status === 1) {
                        bricksLeft++;
                        // Calc pos
                        let brickX = (c*(65+10))+15;
                        let brickY = (r*(20+10))+30;
                        b.x = brickX; b.y = brickY;
                        if(bBallX > b.x && bBallX < b.x+65 && bBallY > b.y && bBallY < b.y+20) {
                            bBallDY = -bBallDY;
                            b.status = 0;
                            breakScore += 10;
                            document.getElementById('breakout-score').innerText = breakScore;
                        }
                    }
                }
            }
            if(bricksLeft === 0) { clearInterval(breakInterval); alert("You Win!"); initBreakout(); return; }

            // Draw
            breakCtx.clearRect(0, 0, 400, 400);
            breakCtx.fillStyle = '#000'; breakCtx.fillRect(0,0,400,400);
            // Bricks
            for(let c=0; c<5; c++) {
                for(let r=0; r<4; r++) {
                    if(bricks[c][r].status === 1) {
                        breakCtx.fillStyle = `hsl(${c*60}, 70%, 50%)`;
                        breakCtx.fillRect((c*(65+10))+15, (r*(20+10))+30, 65, 20);
                    }
                }
            }
            // Paddle
            breakCtx.fillStyle = '#ec4899'; breakCtx.fillRect(paddleX, 400-15, 80, 10);
            // Ball
            breakCtx.beginPath(); breakCtx.arc(bBallX, bBallY, 5, 0, Math.PI*2); breakCtx.fillStyle='#fff'; breakCtx.fill();
        }

        // --- TIC TAC TOE / MEMORY / WHACK (Same as before) ---
        let tttBoard, tttPlayer, tttActive;
        function initTTT() {
            const container = document.querySelector('#tictactoe-game .grid'); container.innerHTML = '';
            tttBoard = ['','','','','','','','','']; tttPlayer = 'X'; tttActive = true;
            document.getElementById('ttt-status').innerText = "Player X's Turn";
            for(let i=0; i<9; i++) {
                const cell = document.createElement('div');
                cell.className = 'w-24 h-24 bg-gray-800 rounded-lg flex items-center justify-center text-4xl font-bold cursor-pointer ttt-cell text-white border-2 border-gray-600';
                cell.onclick = () => {
                    if (tttBoard[i] !== '' || !tttActive) return;
                    tttBoard[i] = tttPlayer; cell.innerText = tttPlayer; cell.classList.add(tttPlayer === 'X' ? 'text-blue-400' : 'text-pink-400');
                    const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
                    let won = false;
                    for(let w of wins) if(tttBoard[w[0]] && tttBoard[w[0]]===tttBoard[w[1]] && tttBoard[w[0]]===tttBoard[w[2]]) won = true;
                    if(won) { document.getElementById('ttt-status').innerText = `Player ${tttPlayer} Wins!`; tttActive = false; return; }
                    if(!tttBoard.includes('')) { document.getElementById('ttt-status').innerText = 'Draw!'; tttActive = false; return; }
                    tttPlayer = tttPlayer === 'X' ? 'O' : 'X'; document.getElementById('ttt-status').innerText = `Player ${tttPlayer}'s Turn`;
                };
                container.appendChild(cell);
            }
        }
        function resetTTT() { initTTT(); }

        let memoryIcons = ['üöÄ','üöÄ','üê±','üê±','üçï','üçï','üåµ','üåµ','üíé','üíé','üé∏','üé∏','üéà','üéà','üç¶','üç¶'];
        let hasFlipped=false, lockBoard=false, firstCard, secondCard, memoryMoves=0, matchesFound=0;
        function initMemory() {
            const grid = document.getElementById('memory-grid'); grid.innerHTML=''; memoryMoves=0; matchesFound=0;
            document.getElementById('memory-moves').innerText=0; hasFlipped=false; lockBoard=false; firstCard=null;
            [...memoryIcons].sort(()=>0.5-Math.random()).forEach(icon => {
                const c = document.createElement('div'); c.className='memory-card w-16 h-16 md:w-20 md:h-20 cursor-pointer relative';
                c.innerHTML=`<div class="memory-card-inner"><div class="memory-card-front"><span class="text-2xl">?</span></div><div class="memory-card-back"><span>${icon}</span></div></div>`;
                c.addEventListener('click', function() {
                    if(lockBoard || this===firstCard) return;
                    this.classList.add('flipped');
                    if(!hasFlipped) { hasFlipped=true; firstCard=this; return; }
                    secondCard=this; memoryMoves++; document.getElementById('memory-moves').innerText=memoryMoves;
                    if(firstCard.innerHTML===secondCard.innerHTML) {
                        firstCard.removeEventListener('click', null); secondCard.removeEventListener('click', null); matchesFound++; resetBoard();
                        if(matchesFound===8) setTimeout(()=>alert(`Won in ${memoryMoves} moves!`),500);
                    } else {
                        lockBoard=true; setTimeout(()=>{ firstCard.classList.remove('flipped'); secondCard.classList.remove('flipped'); resetBoard(); },1000);
                    }
                });
                grid.appendChild(c);
            });
        }
        function resetBoard() { [hasFlipped, lockBoard]=[false,false]; [firstCard, secondCard]=[null,null]; }

        let whackScore=0, lastHole, timeUp=false, whackTime=30, whackTimerInt;
        function startWhackGame() {
            resetWhackUI(); document.getElementById('whack-start-btn').classList.add('hidden');
            timeUp=false; whackScore=0; whackTime=30; document.getElementById('whack-score').innerText=0;
            peep();
            whackTimerInt = setInterval(()=>{
                whackTime--; document.getElementById('whack-time').innerText=whackTime;
                if(whackTime<=0) { clearInterval(whackTimerInt); timeUp=true; document.getElementById('whack-start-btn').classList.remove('hidden'); }
            },1000);
        }
        function peep() {
            const time = Math.round(Math.random()*(1000-500)+500);
            const holes = document.querySelectorAll('.mole-hole');
            const hole = holes[Math.floor(Math.random()*holes.length)];
            const mole = hole.querySelector('.mole');
            mole.style.top='0';
            setTimeout(()=>{ mole.style.top='6rem'; if(!timeUp) peep(); }, time);
        }
        function bonk(e) { if(!timeUp && e.querySelector('.mole').style.top==='0px') { whackScore++; document.getElementById('whack-score').innerText=whackScore; e.querySelector('.mole').style.top='6rem'; } }
        function resetWhackUI() { 
            document.getElementById('whack-score').textContent=0; document.getElementById('whack-time').textContent=30;
            document.querySelectorAll('.mole').forEach(m=>m.style.top='6rem');
        }
        function stopWhack() { timeUp=true; clearInterval(whackTimerInt); }

        // Start in Classics
        switchTab('classics');

    </script>
</body>
</html>